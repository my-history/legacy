!function () { if (window.WebSocket) { var e = document.body.style.cssText, t = "position:fixed; left:0px; top:0px; width:100%; height:100%; margin: 0; padding: 0; overflow:hidden;", i = { position: "fixed", top: "auto", left: "auto", bottom: "20px", right: "20px", width: "64px", height: "64px", "z-index": "2147483647", transform: "translate3d(0, 0, 0)", "-webkit-transform": "translate3d(0, 0, 0)", "background-color": "transparent" }, n = new function () { var e = this; this.defaultTitle = document.title, this.timerId = null; var t = function (i, n) { n++ , document.title = n % 2 ? i : this.defaultTitle, e.timerId = setTimeout(t.bind(e, i, n), 1e3) }; this.show = function (e) { null === this.timerId && (t(e, 0), document.addEventListener("visibilitychange", this.hide)) }, this.hide = function () { document.hidden || (document.title = e.defaultTitle, clearTimeout(e.timerId), e.timerId = null, document.removeEventListener("visibilitychange", e.hide)) } }, a = function () { var e = document.createElement("div"); e.id = "__replain_widget", e.style.cssText = o(i), e.innerHTML = '<iframe id="__replain_widget_iframe" src="https://widget.replain.cc/dist/index.html?1524207244206" scrolling="no" frameBorder="0" allowfullscreen="" style="display:block; visibility:visible; transition:none; background:none transparent; opacity:1; overflow:visible; position:absolute; left:0; top:0; width:100%; min-width:auto; max-width:100vw; height:100%; min-height:auto; max-height:100%; z-index:2147483647; transition:none;"></iframe>', document.body.appendChild(e); var t = document.getElementById("__replain_widget_iframe"); return t.onload = function () { t.contentWindow.postMessage(JSON.stringify({ cmd: "init", data: { chatId: __REPLAIN_, clientInfo: { windowSize: r(), currentUrl: location.href, auth: JSON.parse(localStorage.getItem("REPLAIN_AUTH")) || {}, cache: JSON.parse(localStorage.getItem("REPLAIN_CACHE")) || {} } } }), "*") }, e }(); window.addEventListener("message", function (e) { if (-1 !== e.origin.indexOf("https://widget.replain.cc")) { var t = JSON.parse(e.data); switch (t.cmd) { case "storage-save": localStorage.setItem(t.data.key, JSON.stringify(t.data.data)); break; case "widget-style": s(t.data); break; case "new-message": document.hidden && n.show(t.data) } } }); var d = document.getElementById("__replain_widget_iframe"); window.addEventListener("resize", function () { d.contentWindow.postMessage(JSON.stringify({ cmd: "resize", data: r() }), "*") }) } function o(e) { return JSON.stringify(e).replace(/,/g, ";").replace(/"/g, "").slice(1, -1) } function r() { var e = window, t = document, i = t.documentElement, n = t.getElementsByTagName("body")[0]; return { width: e.innerWidth || i.clientWidth || n.clientWidth, height: e.innerHeight || i.clientHeight || n.clientHeight } } function s(n) { var d = "100%" === n.height, r = navigator.userAgent.match(/(iPad|iPhone|iPod)/g); r && d ? document.body.style.cssText = t : r && !d && (document.body.style.cssText = e), a.style.cssText = o(function (e, t) { for (var i in t) e[i] = t[i]; return e }(i, n)) } }();
